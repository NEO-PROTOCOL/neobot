{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import fs from\"node:fs\";import{createRequire}from\"node:module\";import path from\"node:path\";const formatCommit=__name(value=>{if(!value)return null;const trimmed=value.trim();if(!trimmed)return null;return trimmed.length>7?trimmed.slice(0,7):trimmed},\"formatCommit\");const resolveGitHead=__name(startDir=>{let current=startDir;for(let i=0;i<12;i+=1){const gitPath=path.join(current,\".git\");try{const stat=fs.statSync(gitPath);if(stat.isDirectory()){return path.join(gitPath,\"HEAD\")}if(stat.isFile()){const raw=fs.readFileSync(gitPath,\"utf-8\");const match=raw.match(/gitdir:\\s*(.+)/i);if(match?.[1]){const resolved=path.resolve(current,match[1].trim());return path.join(resolved,\"HEAD\")}}}catch{}const parent=path.dirname(current);if(parent===current)break;current=parent}return null},\"resolveGitHead\");let cachedCommit;const readCommitFromPackageJson=__name(()=>{try{const require2=createRequire(import.meta.url);const pkg=require2(\"../../package.json\");return formatCommit(pkg.gitHead??pkg.githead??null)}catch{return null}},\"readCommitFromPackageJson\");const readCommitFromBuildInfo=__name(()=>{try{const require2=createRequire(import.meta.url);const info=require2(\"../build-info.json\");return formatCommit(info.commit??null)}catch{return null}},\"readCommitFromBuildInfo\");const resolveCommitHash=__name((options={})=>{if(cachedCommit!==void 0)return cachedCommit;const env=options.env??process.env;const envCommit=env.GIT_COMMIT?.trim()||env.GIT_SHA?.trim();const normalized=formatCommit(envCommit);if(normalized){cachedCommit=normalized;return cachedCommit}const buildInfoCommit=readCommitFromBuildInfo();if(buildInfoCommit){cachedCommit=buildInfoCommit;return cachedCommit}const pkgCommit=readCommitFromPackageJson();if(pkgCommit){cachedCommit=pkgCommit;return cachedCommit}try{const headPath=resolveGitHead(options.cwd??process.cwd());if(!headPath){cachedCommit=null;return cachedCommit}const head=fs.readFileSync(headPath,\"utf-8\").trim();if(!head){cachedCommit=null;return cachedCommit}if(head.startsWith(\"ref:\")){const ref=head.replace(/^ref:\\s*/i,\"\").trim();const refPath=path.resolve(path.dirname(headPath),ref);const refHash=fs.readFileSync(refPath,\"utf-8\").trim();cachedCommit=formatCommit(refHash);return cachedCommit}cachedCommit=formatCommit(head);return cachedCommit}catch{cachedCommit=null;return cachedCommit}},\"resolveCommitHash\");export{resolveCommitHash};\n","warnings":[],"map":{"version":3,"mappings":"kHAAA,OAAO,OAAQ,UACf,OAAS,kBAAqB,cAC9B,OAAO,SAAU,YAEjB,MAAM,aAAe,OAAC,OAA0B,CAC9C,GAAI,CAAC,MAAO,OAAO,KACnB,MAAM,QAAU,MAAM,KAAK,EAC3B,GAAI,CAAC,QAAS,OAAO,KACrB,OAAO,QAAQ,OAAS,EAAI,QAAQ,MAAM,EAAG,CAAC,EAAI,OACpD,EALqB,gBAOrB,MAAM,eAAiB,OAAC,UAAqB,CAC3C,IAAI,QAAU,SACd,QAAS,EAAI,EAAG,EAAI,GAAI,GAAK,EAAG,CAC9B,MAAM,QAAU,KAAK,KAAK,QAAS,MAAM,EACzC,GAAI,CACF,MAAM,KAAO,GAAG,SAAS,OAAO,EAChC,GAAI,KAAK,YAAY,EAAG,CACtB,OAAO,KAAK,KAAK,QAAS,MAAM,CAClC,CACA,GAAI,KAAK,OAAO,EAAG,CACjB,MAAM,IAAM,GAAG,aAAa,QAAS,OAAO,EAC5C,MAAM,MAAQ,IAAI,MAAM,iBAAiB,EACzC,GAAI,QAAQ,CAAC,EAAG,CACd,MAAM,SAAW,KAAK,QAAQ,QAAS,MAAM,CAAC,EAAE,KAAK,CAAC,EACtD,OAAO,KAAK,KAAK,SAAU,MAAM,CACnC,CACF,CACF,MAAQ,CAER,CACA,MAAM,OAAS,KAAK,QAAQ,OAAO,EACnC,GAAI,SAAW,QAAS,MACxB,QAAU,MACZ,CACA,OAAO,IACT,EAzBuB,kBA2BvB,IAAI,aAEJ,MAAM,0BAA4B,WAAM,CACtC,GAAI,CACF,MAAMA,SAAU,cAAc,YAAY,GAAG,EAC7C,MAAM,IAAMA,SAAQ,oBAAoB,EAIxC,OAAO,aAAa,IAAI,SAAW,IAAI,SAAW,IAAI,CACxD,MAAQ,CACN,OAAO,IACT,CACF,EAXkC,6BAalC,MAAM,wBAA0B,WAAM,CACpC,GAAI,CACF,MAAMA,SAAU,cAAc,YAAY,GAAG,EAC7C,MAAM,KAAOA,SAAQ,oBAAoB,EAGzC,OAAO,aAAa,KAAK,QAAU,IAAI,CACzC,MAAQ,CACN,OAAO,IACT,CACF,EAVgC,2BAYzB,MAAM,kBAAoB,QAAC,QAAqD,CAAC,IAAM,CAC5F,GAAI,eAAiB,OAAW,OAAO,aACvC,MAAM,IAAM,QAAQ,KAAO,QAAQ,IACnC,MAAM,UAAY,IAAI,YAAY,KAAK,GAAK,IAAI,SAAS,KAAK,EAC9D,MAAM,WAAa,aAAa,SAAS,EACzC,GAAI,WAAY,CACd,aAAe,WACf,OAAO,YACT,CACA,MAAM,gBAAkB,wBAAwB,EAChD,GAAI,gBAAiB,CACnB,aAAe,gBACf,OAAO,YACT,CACA,MAAM,UAAY,0BAA0B,EAC5C,GAAI,UAAW,CACb,aAAe,UACf,OAAO,YACT,CACA,GAAI,CACF,MAAM,SAAW,eAAe,QAAQ,KAAO,QAAQ,IAAI,CAAC,EAC5D,GAAI,CAAC,SAAU,CACb,aAAe,KACf,OAAO,YACT,CACA,MAAM,KAAO,GAAG,aAAa,SAAU,OAAO,EAAE,KAAK,EACrD,GAAI,CAAC,KAAM,CACT,aAAe,KACf,OAAO,YACT,CACA,GAAI,KAAK,WAAW,MAAM,EAAG,CAC3B,MAAM,IAAM,KAAK,QAAQ,YAAa,EAAE,EAAE,KAAK,EAC/C,MAAM,QAAU,KAAK,QAAQ,KAAK,QAAQ,QAAQ,EAAG,GAAG,EACxD,MAAM,QAAU,GAAG,aAAa,QAAS,OAAO,EAAE,KAAK,EACvD,aAAe,aAAa,OAAO,EACnC,OAAO,YACT,CACA,aAAe,aAAa,IAAI,EAChC,OAAO,YACT,MAAQ,CACN,aAAe,KACf,OAAO,YACT,CACF,EA3CiC","names":["require"],"ignoreList":[],"sources":["/Users/nettomello/CODIGOS/neobot/src/infra/git-commit.ts"],"sourcesContent":[null]}}